# Super Mario Bros Reinforcement Learning Experiment

è®­ç»ƒ AI ç©è¶…çº§é©¬é‡Œå¥¥å…„å¼Ÿæ¸¸æˆï¼

## ğŸ® æ¸¸æˆç‰¹æ€§

- **ç¯å¢ƒ**: Nintendo Entertainment System (NES) è¶…çº§é©¬é‡Œå¥¥
- **å…³å¡**: World 1-1 åˆ° 8-4
- **ç®—æ³•**: CNN-DQN (å·ç§¯ç¥ç»ç½‘ç»œ DQN)
- **çŠ¶æ€**: 4 å¸§å †å çš„ 84x84 ç°åº¦å›¾åƒ
- **åŠ¨ä½œ**: 7 ä¸ªç®€å•åŠ¨ä½œï¼ˆå³ã€å³+è·³ã€è·³ç­‰ï¼‰

## ğŸ“ ç›®å½•ç»“æ„

```
experiments/mario/
â”œâ”€â”€ train.py          # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ test.py           # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ models/           # ä¿å­˜çš„æ¨¡å‹
â”‚   â”œâ”€â”€ best_score_model.pth      # æœ€é«˜åˆ†æ¨¡å‹
â”‚   â”œâ”€â”€ best_distance_model.pth   # æœ€è¿œè·ç¦»æ¨¡å‹
â”‚   â””â”€â”€ checkpoint_ep{N}.pth      # å®šæœŸæ£€æŸ¥ç‚¹
â””â”€â”€ logs/             # è®­ç»ƒæ—¥å¿—å’Œå›¾è¡¨
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### è®­ç»ƒ

```bash
# è®­ç»ƒ World 1-1
python train.py --game mario --episodes 10000 --render-every 100

# è®­ç»ƒç‰¹å®šå…³å¡
python train.py --game mario --episodes 10000 --world 1 --stage 2
```

**è®­ç»ƒå‚æ•°ï¼š**

- `--episodes`: è®­ç»ƒå›åˆæ•°ï¼ˆå»ºè®® 10000+ï¼‰
- `--render-every`: æ¯ N è½®æ¸²æŸ“ä¸€æ¬¡
- `--world`: ä¸–ç•Œç¼–å· (1-8)
- `--stage`: å…³å¡ç¼–å· (1-4)

### æµ‹è¯•

```bash
# æµ‹è¯•æœ€ä½³åˆ†æ•°æ¨¡å‹
python test.py --game mario --model experiments/mario/models/best_score_model.pth --episodes 5

# æµ‹è¯•æœ€è¿œè·ç¦»æ¨¡å‹
python test.py --game mario --model experiments/mario/models/best_distance_model.pth --episodes 5

# æµ‹è¯•ç‰¹å®šå…³å¡
python test.py --game mario --world 1 --stage 1 --model {path} --episodes 5
```

## ğŸ“Š è®­ç»ƒè¾“å‡º

è®­ç»ƒè¿‡ç¨‹ä¼šç”Ÿæˆï¼š

1. **æ¨¡å‹æ–‡ä»¶**

   - `best_score_model.pth` - æœ€é«˜åˆ†æ•°æ¨¡å‹
   - `best_distance_model.pth` - åˆ°è¾¾æœ€è¿œä½ç½®çš„æ¨¡å‹
   - `checkpoint_episode_{N}.pth` - å®šæœŸæ£€æŸ¥ç‚¹

2. **è®­ç»ƒå›¾è¡¨**

   - åˆ†æ•°æ›²çº¿
   - æœ€è¿œè·ç¦»æ›²çº¿
   - Epsilon æ¢ç´¢ç‡
   - è®­ç»ƒæŸå¤±

3. **è®­ç»ƒå†å²**
   - `training_history.pkl` - å®Œæ•´è®­ç»ƒæ•°æ®

## ğŸ¯ è®­ç»ƒç›®æ ‡

### çŸ­æœŸç›®æ ‡ï¼ˆå‰ 1000 è½®ï¼‰

- å­¦ä¹ åŸºæœ¬ç§»åŠ¨ï¼ˆå‘å³èµ°ï¼‰
- é¿å¼€ç®€å•éšœç¢ç‰©
- è·³è¿‡å°å‘

### ä¸­æœŸç›®æ ‡ï¼ˆ1000-5000 è½®ï¼‰

- è·³è¿‡å¤šä¸ªéšœç¢
- å‡»è´¥æ•Œäºº
- åˆ°è¾¾æ›´è¿œè·ç¦»

### é•¿æœŸç›®æ ‡ï¼ˆ5000+è½®ï¼‰

- å®Œæˆå…³å¡
- è·å¾—é«˜åˆ†
- ç¨³å®šé€šå…³

## âš™ï¸ ç½‘ç»œæ¶æ„

**CNN-DQN ç½‘ç»œï¼š**

```
è¾“å…¥: 4 x 84 x 84 (4å¸§å †å )
  â†“
Conv1: 32 filters, 8x8, stride 4 â†’ ReLU
  â†“
Conv2: 64 filters, 4x4, stride 2 â†’ ReLU
  â†“
Conv3: 64 filters, 3x3, stride 1 â†’ ReLU
  â†“
Flatten
  â†“
FC1: 512 units â†’ ReLU
  â†“
FC2: 7 units (åŠ¨ä½œ)
```

## ğŸ’¡ è®­ç»ƒæŠ€å·§

1. **è€å¿ƒå¾ˆé‡è¦** - CNN-DQN éœ€è¦å¤§é‡è®­ç»ƒæ‰èƒ½å­¦ä¼š
2. **GPU åŠ é€Ÿ** - å¼ºçƒˆå»ºè®®ä½¿ç”¨ GPU è®­ç»ƒ
3. **è§‚å¯Ÿè¿›åº¦** - ç›‘æ§æœ€è¿œè·ç¦»è€Œä¸åªæ˜¯åˆ†æ•°
4. **è°ƒæ•´æ¢ç´¢** - Epsilon è¡°å‡å¾ˆæ…¢ï¼Œç¡®ä¿å……åˆ†æ¢ç´¢
5. **ä»ç®€å•å…³å¡å¼€å§‹** - World 1-1 æ˜¯æœ€å¥½çš„èµ·ç‚¹

## ğŸ”§ è¶…å‚æ•°

```python
{
    "gamma": 0.99,              # æŠ˜æ‰£å› å­
    "learning_rate": 0.00025,   # å­¦ä¹ ç‡
    "batch_size": 32,           # æ‰¹æ¬¡å¤§å°
    "memory_size": 100000,      # ç»éªŒå›æ”¾å¤§å°
    "target_update_freq": 10000, # ç›®æ ‡ç½‘ç»œæ›´æ–°é¢‘ç‡
    "epsilon_start": 1.0,       # åˆå§‹æ¢ç´¢ç‡
    "epsilon_end": 0.1,         # æœ€å°æ¢ç´¢ç‡
    "epsilon_decay": 0.999995,  # æ¢ç´¢ç‡è¡°å‡
}
```

## ğŸ“ˆ é¢„æœŸæ€§èƒ½

| è®­ç»ƒè½®æ•°   | é¢„æœŸè¡¨ç°                  |
| ---------- | ------------------------- |
| 0-500      | å­¦ä¹ å‘å³ç§»åŠ¨              |
| 500-2000   | è·³è¿‡ç®€å•éšœç¢ï¼Œåˆ°è¾¾ X=500+ |
| 2000-5000  | é¿å¼€æ•Œäººï¼Œåˆ°è¾¾ X=1000+    |
| 5000-10000 | å¯èƒ½é€šè¿‡éƒ¨åˆ†å…³å¡          |
| 10000+     | ç¨³å®šåˆ°è¾¾è¿œè·ç¦»ï¼Œå¶å°”é€šå…³  |

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **è®­ç»ƒæ—¶é—´é•¿** - å¯èƒ½éœ€è¦æ•°å°æ—¶ç”šè‡³æ•°å¤©
2. **GPU æ¨è** - CPU è®­ç»ƒä¼šéå¸¸æ…¢
3. **å†…å­˜å ç”¨** - 100k ç»éªŒå›æ”¾éœ€è¦è¾ƒå¤šå†…å­˜
4. **æ¸²æŸ“å½±å“** - é¢‘ç¹æ¸²æŸ“ä¼šå‡æ…¢è®­ç»ƒé€Ÿåº¦

## ğŸ“ å­¦ä¹ èµ„æº

- [gym-super-mario-bros æ–‡æ¡£](https://github.com/Kautenja/gym-super-mario-bros)
- [DQN è®ºæ–‡](https://www.nature.com/articles/nature14236)
- [CNN-DQN æ¶æ„](https://arxiv.org/abs/1312.5602)

---

**å‡†å¤‡å¥½è®­ç»ƒä½ çš„é©¬é‡Œå¥¥ AI äº†å—ï¼Ÿ** ğŸ„ğŸ®
